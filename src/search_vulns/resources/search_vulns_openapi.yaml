{
  "components": {
    "schemas": {
      "CheckKeyStatusIn": {
        "properties": {
          "key": {
            "description": "API Key to check",
            "title": "Key",
            "type": "string"
          }
        },
        "required": [
          "key"
        ],
        "title": "CheckKeyStatusIn",
        "type": "object"
      },
      "CheckKeyStatusResult": {
        "properties": {
          "status": {
            "description": "'valid' if key is valid, otherwise a reason for why it is not",
            "title": "Status",
            "type": "string"
          }
        },
        "required": [
          "status"
        ],
        "title": "CheckKeyStatusResult",
        "type": "object"
      },
      "HTTPError": {
        "properties": {
          "detail": {
            "type": "object"
          },
          "message": {
            "type": "string"
          }
        },
        "type": "object"
      },
      "SearchVulnsResult": {
        "properties": {
          "pot_product_ids": {
            "$ref": "#/components/schemas/SearchVulnsResult.PotProductIDsResult",
            "description": "Stores other relevant product IDs that did not match fully"
          },
          "product_ids": {
            "$ref": "#/components/schemas/SearchVulnsResult.ProductIDsResult",
            "description": "Stores successfully matched product IDs"
          },
          "schema_version": {
            "const": "1.0.0",
            "default": "1.0.0",
            "description": "Schema version of this model",
            "title": "Schema Version",
            "type": "string"
          },
          "version_status": {
            "$ref": "#/components/schemas/SearchVulnsResult.VersionStatusResult",
            "description": "Provides status about queried software version if available"
          },
          "vulns": {
            "additionalProperties": {
              "$ref": "#/components/schemas/SearchVulnsResult.Vulnerability"
            },
            "description": "Stores retrieved vulnerabilities",
            "propertyNames": {
              "description": "Vulnerability ID",
              "minLength": 1
            },
            "title": "Vulns",
            "type": "object"
          }
        },
        "title": "search_vulns Result Model",
        "type": "object"
      },
      "SearchVulnsResult.DataSource": {
        "enum": [
          "nvd",
          "nvd++",
          "ghsa",
          "osv.dev",
          "debian",
          "ubuntu",
          "redhat",
          "product_specific",
          "other"
        ],
        "title": "DataSource",
        "type": "string"
      },
      "SearchVulnsResult.Match": {
        "properties": {
          "confidence": {
            "description": "Confidence for the match",
            "exclusiveMinimum": 0,
            "maximum": 1,
            "title": "Confidence",
            "type": "number"
          },
          "match_reason": {
            "$ref": "#/components/schemas/SearchVulnsResult.MatchReason",
            "description": "Reason for the match"
          }
        },
        "required": [
          "match_reason",
          "confidence"
        ],
        "title": "Vulnerability Match Model",
        "type": "object"
      },
      "SearchVulnsResult.MatchReason": {
        "enum": [
          "product_match",
          "version_in_range",
          "general_product_ok",
          "description_match",
          "general_product_uncertain",
          "single_higher_version",
          "vuln_id",
          "n_a"
        ],
        "title": "MatchReason",
        "type": "string"
      },
      "SearchVulnsResult.PotProductIDsResult": {
        "properties": {
          "cpe": {
            "description": "A list containing tuples of a CPE and a match score, sorted by abs(match score)",
            "items": {
              "maxItems": 2,
              "minItems": 2,
              "prefixItems": [
                {
                  "type": "string"
                },
                {
                  "maximum": 1,
                  "minimum": -1,
                  "type": "number"
                }
              ],
              "type": "array"
            },
            "title": "Cpe",
            "type": "array"
          },
          "purl": {
            "description": "A list containing tuples of a PURL and a match score, sorted by abs(match score)",
            "items": {
              "maxItems": 2,
              "minItems": 2,
              "prefixItems": [
                {
                  "type": "string"
                },
                {
                  "maximum": 1,
                  "minimum": -1,
                  "type": "number"
                }
              ],
              "type": "array"
            },
            "title": "Purl",
            "type": "array"
          },
          "raw": {
            "description": "A list containing tuples of a raw string / product ID and a match score, sorted by abs(match score)",
            "items": {
              "maxItems": 2,
              "minItems": 2,
              "prefixItems": [
                {
                  "type": "string"
                },
                {
                  "maximum": 1,
                  "minimum": -1,
                  "type": "number"
                }
              ],
              "type": "array"
            },
            "title": "Raw",
            "type": "array"
          }
        },
        "title": "search_vulns Potential ProductID Result Model",
        "type": "object"
      },
      "SearchVulnsResult.ProductIDsResult": {
        "properties": {
          "cpe": {
            "description": "A list of CPEs",
            "items": {
              "type": "string"
            },
            "title": "Cpe",
            "type": "array"
          },
          "purl": {
            "description": "A list of PURLs",
            "items": {
              "type": "string"
            },
            "title": "Purl",
            "type": "array"
          },
          "raw": {
            "description": "A list of raw/different/other product IDs",
            "items": {
              "type": "string"
            },
            "title": "Raw",
            "type": "array"
          }
        },
        "title": "search_vulns ProductID Result Model",
        "type": "object"
      },
      "SearchVulnsResult.SeverityCVSS": {
        "properties": {
          "score": {
            "description": "CVSS score",
            "minLength": 1,
            "title": "Score",
            "type": "string"
          },
          "type": {
            "const": "CVSS",
            "default": "CVSS",
            "title": "Type",
            "type": "string"
          },
          "vector": {
            "description": "CVSS vector",
            "minLength": 1,
            "title": "Vector",
            "type": "string"
          },
          "version": {
            "description": "CVSS version",
            "minLength": 1,
            "title": "Version",
            "type": "string"
          }
        },
        "required": [
          "score",
          "version",
          "vector"
        ],
        "title": "CVSS Severity Model",
        "type": "object"
      },
      "SearchVulnsResult.SeverityEPSS": {
        "properties": {
          "score": {
            "description": "EPSS score",
            "minLength": 1,
            "title": "Score",
            "type": "string"
          },
          "type": {
            "const": "EPSS",
            "default": "EPSS",
            "title": "Type",
            "type": "string"
          }
        },
        "required": [
          "score"
        ],
        "title": "EPSS Severity Model",
        "type": "object"
      },
      "SearchVulnsResult.SeverityType": {
        "enum": [
          "CVSS",
          "EPSS"
        ],
        "title": "SeverityType",
        "type": "string"
      },
      "SearchVulnsResult.VersionStatus": {
        "enum": [
          "EOL",
          "CURRENT",
          "OUTDATED",
          "N/A"
        ],
        "title": "VersionStatus",
        "type": "string"
      },
      "SearchVulnsResult.VersionStatusResult": {
        "properties": {
          "latest": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "default": null,
            "description": "Latest version",
            "title": "Latest"
          },
          "reference": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "default": null,
            "description": "Reference / url where where the information originates",
            "title": "Reference"
          },
          "status": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/SearchVulnsResult.VersionStatus"
              },
              {
                "type": "null"
              }
            ],
            "default": null,
            "description": "Actual version status"
          }
        },
        "title": "search_vulns Version Status Result Model",
        "type": "object"
      },
      "SearchVulnsResult.Vulnerability": {
        "properties": {
          "aliases": {
            "additionalProperties": {
              "description": "Reference or URL",
              "minLength": 1,
              "type": "string"
            },
            "description": "Stores different IDs (aliases) for the vulnerability, alongside references with more details about the vulnerability and its ID",
            "propertyNames": {
              "description": "Alias / vulnerability ID",
              "minLength": 1
            },
            "title": "Aliases",
            "type": "object"
          },
          "cisa_kev": {
            "default": false,
            "description": "Stores if the vulnerability is a CISA KEV",
            "title": "Cisa Kev",
            "type": "boolean"
          },
          "cwe_ids": {
            "description": "Stores CWE-IDs for the vulnerability",
            "items": {
              "type": "string"
            },
            "title": "Cwe Ids",
            "type": "array",
            "uniqueItems": true
          },
          "description": {
            "default": "",
            "description": "Description of the vulnerability",
            "title": "Description",
            "type": "string"
          },
          "exploits": {
            "description": "Stores exploits references",
            "items": {
              "description": "Exploit URL",
              "minLength": 1,
              "type": "string"
            },
            "title": "Exploits",
            "type": "array",
            "uniqueItems": true
          },
          "id": {
            "description": "Unique identifier for this vulnerability",
            "minLength": 1,
            "title": "Id",
            "type": "string"
          },
          "match_reason": {
            "$ref": "#/components/schemas/SearchVulnsResult.MatchReason",
            "description": "Reason for why this vulnerability was matched"
          },
          "matched_by": {
            "additionalProperties": {
              "$ref": "#/components/schemas/SearchVulnsResult.Match"
            },
            "description": "Stores by which data sources the vulnerability was matched by",
            "minProperties": 1,
            "title": "Matched By",
            "type": "object"
          },
          "misc": {
            "additionalProperties": true,
            "description": "Other optional information about the vulnerability",
            "title": "Misc",
            "type": "object"
          },
          "modified": {
            "default": null,
            "description": "Modified date of the vulnerability",
            "format": "date-time",
            "title": "Modified",
            "type": "string"
          },
          "published": {
            "default": null,
            "description": "Publish date of the vulnerability",
            "format": "date-time",
            "title": "Published",
            "type": "string"
          },
          "reported_patched_by": {
            "description": "Stores by which data sources the matched to product is considered patched against the vulnerability",
            "items": {
              "anyOf": [
                {
                  "$ref": "#/components/schemas/SearchVulnsResult.DataSource"
                },
                {
                  "description": "Textual identifier for the data source",
                  "minLength": 1,
                  "type": "string"
                }
              ]
            },
            "minItems": 1,
            "title": "Reported Patched By",
            "type": "array",
            "uniqueItems": true
          },
          "severity": {
            "additionalProperties": {
              "anyOf": [
                {
                  "$ref": "#/components/schemas/SearchVulnsResult.SeverityCVSS"
                },
                {
                  "$ref": "#/components/schemas/SearchVulnsResult.SeverityEPSS"
                }
              ]
            },
            "description": "Stores different severity types for the vulnerability",
            "propertyNames": {
              "$ref": "#/components/schemas/SearchVulnsResult.SeverityType"
            },
            "title": "Severity",
            "type": "object"
          },
          "tracked_by": {
            "additionalProperties": {
              "description": "Reference where the data source tracks this vulnerability",
              "minLength": 1,
              "type": "string"
            },
            "description": "Stores which data sources keep track of this vulnerability and where",
            "minProperties": 1,
            "title": "Tracked By",
            "type": "object"
          }
        },
        "required": [
          "id",
          "match_reason",
          "tracked_by",
          "matched_by"
        ],
        "title": "Vulnerability Model",
        "type": "object"
      },
      "SoftwareVersionResult": {
        "properties": {
          "last_db_update": {
            "description": "Datetime string of when the local database was last updated",
            "title": "Last Db Update",
            "type": "string"
          },
          "last_db_update_ts": {
            "description": "Epoch timestamp of when the local database was last updated",
            "title": "Last Db Update Ts",
            "type": "number"
          },
          "version": {
            "description": "Version of search_vulns software",
            "title": "Version",
            "type": "string"
          }
        },
        "required": [
          "version",
          "last_db_update",
          "last_db_update_ts"
        ],
        "title": "SoftwareVersionResult",
        "type": "object"
      },
      "ValidationError": {
        "properties": {
          "detail": {
            "properties": {
              "<location>": {
                "properties": {
                  "<field_name>": {
                    "items": {
                      "type": "string"
                    },
                    "type": "array"
                  }
                },
                "type": "object"
              }
            },
            "type": "object"
          },
          "message": {
            "type": "string"
          }
        },
        "type": "object"
      }
    },
    "securitySchemes": {
      "ApiKeyAuth": {
        "in": "header",
        "name": "API-Key",
        "type": "apiKey"
      }
    }
  },
  "info": {
    "contact": {
      "name": "search_vulns Support",
      "url": "https://github.com/ra1nb0rn/search_vulns/issues"
    },
    "description": "Welcome to the search_vulns API!<br>This API allows you to search for vulnerabilities, exploits, product IDs and more.<br>An API key is required to use the API. It can be set up at <a href=\"/api/setup\">/api/setup</a>.",
    "license": {
      "name": "MIT",
      "url": "https://github.com/ra1nb0rn/search_vulns/blob/master/LICENSE"
    },
    "title": "search_vulns API",
    "version": "1.0.0"
  },
  "openapi": "3.0.3",
  "paths": {
    "/api/check-key-status": {
      "post": {
        "description": "Check the status of your API key.",
        "parameters": [],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CheckKeyStatusIn"
              }
            }
          }
        },
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CheckKeyStatusResult"
                }
              }
            },
            "description": "Successful response"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationError"
                }
              }
            },
            "description": "Validation error"
          }
        },
        "summary": "Check API key status",
        "tags": [
          "Public Api"
        ]
      }
    },
    "/api/product-id-suggestions": {
      "get": {
        "description": "Retrieve product IDs and suggestions that match the queried product.",
        "parameters": [
          {
            "in": "query",
            "name": "query",
            "required": true,
            "schema": {
              "description": "Query product to search IDs for, e.g. 'Tomcat 9.0.22'",
              "title": "Query",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SearchVulnsResult"
                }
              }
            },
            "description": "Successful response"
          },
          "401": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPError"
                }
              }
            },
            "description": "Authentication error"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationError"
                }
              }
            },
            "description": "Validation error"
          },
          "429": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPError"
                }
              }
            },
            "description": "Too Many Requests"
          }
        },
        "security": [
          {
            "ApiKeyAuth": []
          }
        ],
        "summary": "Retrieve Product IDs",
        "tags": [
          "Public Api"
        ]
      }
    },
    "/api/search-vulns": {
      "get": {
        "description": "Search for known vulnerabilities, exploits and more by using search_vulns' core engine and its modules.",
        "parameters": [
          {
            "in": "query",
            "name": "query",
            "required": true,
            "schema": {
              "description": "Query product to search vulnerabilities for, e.g. 'Tomcat 9.0.22'",
              "title": "Query",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "ignore-general-product-vulns",
            "required": false,
            "schema": {
              "default": "false",
              "enum": [
                "true",
                "false"
              ],
              "title": "Ignore-General-Product-Vulns",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "include-single-version-vulns",
            "required": false,
            "schema": {
              "default": "false",
              "enum": [
                "true",
                "false"
              ],
              "title": "Include-Single-Version-Vulns",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "is-good-product-id",
            "required": false,
            "schema": {
              "default": "true",
              "enum": [
                "true",
                "false"
              ],
              "title": "Is-Good-Product-Id",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "include-patched",
            "required": false,
            "schema": {
              "default": "false",
              "enum": [
                "true",
                "false"
              ],
              "title": "Include-Patched",
              "type": "string"
            }
          },
          {
            "in": "query",
            "name": "use-created-product-ids",
            "required": false,
            "schema": {
              "default": "false",
              "enum": [
                "true",
                "false"
              ],
              "title": "Use-Created-Product-Ids",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SearchVulnsResult"
                }
              }
            },
            "description": "Successful response"
          },
          "401": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPError"
                }
              }
            },
            "description": "Authentication error"
          },
          "422": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationError"
                }
              }
            },
            "description": "Validation error"
          },
          "429": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPError"
                }
              }
            },
            "description": "Too Many Requests"
          }
        },
        "security": [
          {
            "ApiKeyAuth": []
          }
        ],
        "summary": "Search for known vulnerabilities, exploits and more",
        "tags": [
          "Public Api"
        ]
      }
    },
    "/api/version": {
      "get": {
        "description": "Retrieve the version of search_vulns and datetime of the latest DB update.",
        "parameters": [],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SoftwareVersionResult"
                }
              }
            },
            "description": "Successful response"
          }
        },
        "summary": "Retrieve search_vulns version information",
        "tags": [
          "Public Api"
        ]
      }
    }
  },
  "servers": [
    {
      "url": "http://localhost:8080/"
    }
  ],
  "tags": [
    {
      "name": "Public Api"
    }
  ]
}
